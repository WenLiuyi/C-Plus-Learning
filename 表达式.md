#  表达式

* 重载运算符：作用于类对象时，可自行定义含义。
  
  * 例：IO库的>>, <<运算符；string对象，vector对象
  
  * 可定义：运算对象的类型、返回值的类型

* 左值 & 右值：
  
  * 对象被用作右值时：用的是对象的**值（内容）**
  
  * 对象被用作左值时：用的是对象的**身份（在内存中的位置）**
  
  > 使用decltype时：若表达式求值结果是**左值**，decltype作用于该表达式（不是变量），得到一个**引用类型**。
  > 
  > 1. 假设p的类型是int *，**解引用运算符生成左值**：decltype(*p)的结果是int &
  > 
  > 2. **取地址运算符生成右值**：decltype(&p)的结果是int **

## 1. 算术运算符

一元：+，-

二元：+，-，*，/，%

* 算术运算符的**运算对象、求值结果**都是**右值**

* 表达式求值前，小整数类型的运算对象，被提升成较大整数类型，最终转为同一类型

* C++11标准：商一律向0取整

## 2. 逻辑和关系运算符

* 逻辑运算符作用于：任意能转成布尔值的类型；返回值都是布尔类型

* 运算对象、求值结果都是**右值**

* 短路求值：对于&&和||

## 3. 赋值运算符

* 赋值运算的左侧运算对象必须是：**可修改的左值**
  
  > 1024=k;    // 错误：字面值是右值
  > i+j=k;        // 错误：算术表达式是右值

* 赋值运算满足**右结合律**：
  
  ```c++
  int ival,jval;
  ival=jval=0;    // 正确：都被赋值为0
  ```
  
  * jval=0作为靠左的赋值运算符的右侧运算对象
  
  * 赋值运算返回：其左侧运算对象，故靠右的赋值运算结果（即jval）被赋给ival
  
  * 赋值运算优先级<关系运算符优先级
    
    * 必须加括号
    
    ```c++
    int i;
    while((i=get_value())!=42){
        // process
    }
    ```

## 4. 递增、递减运算符

前置版本：++i；后置版本：i++

> 建议使用前置版本：后置版本需要存储原始值，以便返回该未修改的内容（性能降低）

* 后置运算优先级>解引用运算优先级：
  
  * *pbeg++等价于 *(pbeg++)：**把pbeg的值+1，返回pbeg的初始值副本作为求值结果**

## 5. 成员访问运算符

* 点运算：获取类对象的一个成员
  
  * ptr->mem等价于：(*ptr).mem

* 优先级：点运算>解引用运算
  
  * n=(*p).size();    // 必须加括号

* 箭头运算符作用于**指针类型**的运算对象，结果是**左值**；

* 点运算：若成员所属对象是左值，则结果是左值；若成员所属对象是右值，则结果是右值

## 6. 条件运算符

cond?expr1:expr2;

* 当条件运算符的两个表达式都是左值 / 能转换成同一种左值类型时，运算结果：左值；否则运算结果是右值

### 6.1 嵌套条件运算符

* 满足**右结合律**：运算对象按照从右向左的顺序组合，靠右边的运算构成靠左边的条件运算的：分支

* 条件运算符优先级非常低

## 7. 位运算符

### 7.1 移位运算符

* 左侧运算对象，按右侧运算对象的要求移动指定位数；将经过移动的**左侧运算对象的拷贝**作为求值结果

* 左移运算符：右侧插入值为0的二进制位；

* 右移运算符：
  
  * 无符号类型：左侧插入值为0的二进制位；
  
  * 带符号类型：左侧插入符号位的副本/值为0的二进制位

* 移位运算符（IO运算符）满足：**左结合律**

* **优先级：算术运算符 > 移位运算符 > 关系运算符 > 赋值运算符 > 条件运算符**

### 7.2 位求反运算符

* 运算对象**逐位求反**，生成一个新值

### 7.3 位与、位或、位异或运算符



## 8. sizeof运算符

* 返回：一条表达式/一个类型名字所占的**字节数**

* 满足**右结合律**；所得值为**size_t类型的常量表达式**

* 优先级：**sizeof与解引用符*一样**
  
  * sizeof *p：从右向左结合

* sizeof不实际计算其运算对象的值
  
  * sizeof *p：即使p是无效（未初始化）的指针，也没关系（sizeof无需解引用指针，即可知道所指对象类型）

* sizeof运用场景：无需提供具体对象
  
  * 对引用类型：**被引用对象所占空间大小**
  
  * 对解引用指针：指针所指对象所占空间大小（**指针可以无效**）
  
  * 对数组：整个数组所占空间大小
  
  * 对string/vector对象：该类型固定部分大小（不会计算对象中元素占用的空间大小）
    
    

## 9. 逗号运算符

* 含有两个运算对象，按照**从左向右**的顺序依次求值

* 首先对左侧表达式求值，然后将求值结果丢弃；真正的结果是**右侧表达式的值**
  
  * 若右侧运算对象是左值，最终求值结果也是左值
    
    

## 10. 类型转换

### 10.1 算术转换
